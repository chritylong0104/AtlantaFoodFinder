<!-- restaurant_details/templates/restaurant_details/restaurant_detail.html -->
{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="restaurant-details">
    <div class="hero-image">
        <img src="{{ restaurant.image_url }}" alt="{{ restaurant.name }}">
        <div class="hero-text">
            <h1>{{ restaurant.name }}</h1>
            <div class="rating">Rating: {{ restaurant.rating }}</div>
        </div>
        <a href="{% url 'restaurant_list' %}" class="back-arrow"><i class="fas fa-arrow-left"></i></a>
        <button class="favorite-btn" data-restaurant-id="{{ restaurant.id }}" onclick="toggleFavorite('{{ restaurant.id }}')">
            {% if restaurant.id in favorites %}
                Remove from Favorites
            {% else %}
                Add to Favorites
            {% endif %}
        </button>
    </div>

    <div class="container mt-4">
        <p>Address: {{ restaurant.address }}</p>
        <p>Contact: {{ place_details.formatted_phone_number }}</p>
        <p>Cuisine: {{ restaurant.cuisine_type }}</p>

        <div class="hours">
            <h3>Opening Hours</h3>
            <ul>
                {% for day, hours in place_details.opening_hours.items %}
                    <li>{{ day }}: {{ hours }}</li>
                {% endfor %}
            </ul>
        </div>

        <div class="reviews">
            <h2>Reviews</h2>
            {% for review in place_details.reviews %}
                <div class="review-card">
                    <h3>{{ review.author_name }}</h3>
                    <div class="rating">Rating: {{ review.rating }}</div>
                    <p>{{ review.text }}</p>
                    <div class="review-date">{{ review.relative_time_description }}</div>
                </div>
            {% endfor %}
        </div>

        <div class="map-container">
            <div id="map"></div>
        </div>
    </div>
</div>

{% csrf_token %}
<script src="https://maps.googleapis.com/maps/api/js?key={{ google_maps_api_key }}"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="{% static 'js/favorites.js' %}"></script>
<script>
    function initMap() {
        var restaurant = {lat: {{ restaurant.latitude }}, lng: {{ restaurant.longitude }}};
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 15,
            center: restaurant
        });
        var marker = new google.maps.Marker({
            position: restaurant,
            map: map
        });
    }
    initMap();
</script>
{% endblock %}